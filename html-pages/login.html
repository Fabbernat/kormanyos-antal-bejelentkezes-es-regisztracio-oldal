<!DOCTYPE html>
<html lang="hu">

<head>
    <meta charset="UTF-8">
    <title>Saját oldal</title>
    <link rel="stylesheet" href="../css/style.css">
</head>

<body>
    <header>
        <h1>Üdvözöllek az oldalamon</h1>
        <nav>
            <ul>
                <li><a href="index.html">Főoldal</a></li>
                <li><a href="signup.html">Regisztráció</a></li>
                <li><a href="login.html">Bejelentkezés</a></li>
                <li><a href="../js/logout.js">Kijelentkezés</a></li>
            </ul>
        </nav>
    </header>
    <main id="page">
        <div style="margin: auto; width: 50%; text-align: center">
            <h1>Bejelentkezés</h1>
            <form id="loginForm" action="login.html" method="POST">
                <fieldset>
                    <legend>Bejelentkezés adatok</legend>
                    <label>Felhasználónév: <br><input type="text" name="felhasznalonev" /></label> <br />
                    <label>Jelszó: <br><input type="password" name="jelszo" /></label> <br />
                    <input type="submit" value="Login" name="login" /> <br /><br />
                    <script>console.log(uzenet);</script>
                </fieldset>
            </form>
        </div>
    </main>
    <script>
        // Betöltjük a felhasználókat
        let fiokok = {};

        fetch("json/users.json")
            .then(r => r.json())
            .then(data => { fiokok = data; });

        document.getElementById("loginForm").addEventListener("submit", function (e) {
            e.preventDefault();

            const felhasznalonev = this.felhasznalonev.value.trim();
            const jelszo = this.jelszo.value.trim();

            // Üres mezők ellenőrzése
            if (!felhasznalonev && !jelszo) {
                alert("Hiba: Kérlek add meg a felhasználónevet és a jelszót!");
                return;
            }
            if (!felhasznalonev) {
                alert("Hiba: Kérlek add meg a felhasználónevet!");
                return;
            }
            if (!jelszo) {
                alert("Hiba: Kérlek add meg a jelszót!");
                return;
            }

            // Felhasználó ellenőrzése
            if (!(felhasznalonev in fiokok)) {
                alert("Hiba: Ez a felhasználónév nem létezik!");
                return;
            }

            // Jelszó ellenőrzése
            if (fiokok[felhasznalonev] !== jelszo) {
                alert("Hiba: Hibás jelszó!");
                return;
            }

            // Sikeres belépés
            alert("Sikeres belépés! Üdv újra, " + felhasznalonev + "!");
        });
    </script>
</body>

</html>